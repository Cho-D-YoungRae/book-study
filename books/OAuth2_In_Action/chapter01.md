# Chapter 01. OAuth2.0 이 무엇이고, 왜 관심을 가져야 할까?

## 1.1 OAuth 2.0 은 무엇인가?

- 자신이 소유한 리소스에 소프트웨어 애플리케이션이 접근할 수 있도록 허용해줌으로써 접근 권한을 위임해주는 프로토콜
- 애플리케이션이 리소스 소유자에게 리소스에 대한 접근 권한을 요청하고, 요청 결과로 전달 받은 토큰을 이용해 애플리케이션이 해당 리소스에 접근하느 프로토콜
- 클라이언트의 접근 권한을 리소스 소유자가 허용한 범위로 제한할 수 있음
- 시스템의 어떤 구성 요소가 다른 시스템의 어떤 구성 요소에 대한 접근 권한을 얻을 수 있게 해줌

## 1.2 과거: 자격 증명 공유(그리고 자격 증명 탈취)

- 사용자의 자격 증명을 복사해 연결하고자 하는 다른 서비스에 전달하는 방법
  - 클라이언트는 자신에게 전달된 자격 증명이 사용자가 자신의 리소스 서버에서 사용하는 자격 증명과 동일하다고 가정
  - 클라이언트가 마치 자신이 사용자인 것처럼 사용자가 입력한 사용자 이름과 비밀번호를 사진 저장 사이트에 전달
  - 클라이언트는 사용자 행세를 하는 데 필요한 사용자 이름과 비밀번호 또는 도메인 세션 쿠키와 같은 자격증명을 전달 받음
  - 클라이언트는 마치 사용자가 직접 로그인한 것과 동일하게 보호된 리소스에 접근
  - 클라이언트 애플리케이션과 보호된 리소스에 대한 사용자의 자격 증명이 동일해야 하며, 그렇게 하면 자격 증명 탈취에 대한 보안성이 제한됨
  - 사용자의 비밀번호가 클라이언트에 노출됨
  - 리소스 서버 입장에서는 자신에게 접근하는 것이 실제 리소스 소유자인지 클라이언트인지 구분할 수 없음
- 사용자에게 사용자 이름과 비밀번호를 물어보는 방법
  - 사용자 이름과 비밀번호를 입력하라고 요청
  - 그런 다음 앞의 경우와 마찬가지로 클라이언트는 사용자의 자격 증명을 전달함으로써 사용자로 가장해 사용자의 보호된 리소스에 접근
  - 클라이언트에 로그인하기 위해 사용한 자격 증명은 보호된 리소스에 접근하기 위한 자격 증명과 다를 수 있음
  - 하지만 클라이언트는 사용자에게 보호된 리소스에 접근하기 위한 사용자 이름과 비밀번호를 직접 요청하게됨
  - LDAP 도 이런 방식
  - 리소스에 접근 제한 불가
- 개발자 키를 클라이언트에 발급하고, 클라이언트는 그것을 이용해 보호된 리로스를 집접 요청하는 방법
  - 개발자 키는 사용자를 나타내는 일종의 범용적인 키의 역할
  - 사용자의 자격 증명이 클라이언트에 노출되지 않음
  - 클라이언트에게는 매우 강렬한 자격 증명이 요구됨
  - 클라이언트는 모든 사용자의 보호된 리소스 데이터를 효과적으로 자유롭게 사용할 수 있게 됨
  - 어느 정도까지는 유효하지만 보호된 리소스가 클라이언트를 완전히 알고 신뢰할 수 있는 경우에만 가능
  - 사용자의 자격 증명이 탈최된다면 보호된 리소스에 미치는 피해는 치명적
    - 왜냐하면 사용자가 해당 클라이언트를 사용하는지 여부와는 상관없이 사진 저장 서비스를 이용하는 모든 사용자의 데이터가 유출될 수 있음
- 서드파티 서비스와 공유할 목적으로만 사용되는 특별한 비밀번호를 사용자에게 발급
  - 사용자는 발급받은 비밀번호를 로그인하는 용도로 사용하지 않고 자신이 이용하기 위한 애플리케이션에 전달

## 1.3 접근 권한 위임

- OAuth 는 사용자가 보호된 리소스에 대한 자신의 접근 권한 일부를 클라이언트 애플리케이션에게 위임하기 위해 설계된 프로토콜

### 1.3.1 HTTP Basic 과 비밀번호 공유 방식을 넘어

- OAuth 는 원래 API 를 사용하기 위해 설계

### 1.3.2 권한 위임: 중요성과 사용 방법

- OAuth 힘의 기반은 권한 위임이라는 개념

### 1.3.3 사용자 주도 보안과 사용자 선택

- OAuth 권한 위임 절차에는 리소스 소유자가 포함됨

## 1.4 OAuth2.0: 좋은 점과 나쁜 점

- OAuth2.0 은 사용자의 권한 위임 결정을 캡처하고 그것을 네트워크 상에 표현하는 데 뛰어남
- 보안 결정 절차에는 여러 당사자가 참여할 수 있음
- 런타임 시에는 사용자가 보안 결정
- 인가 서버나 보호된 리소스 서버보다 몇 배 더 많은 클라이언트가 있을 수 있음
- 클라이언트를 여러 가지 신뢰 레벨로 분류할 수 있음
  - 신뢰된 클라이언트, 인증된 클라이언트, 동적으로 등록된 클라이언트
- 확장성과 모듈화

## OAuth 2.0 이 아닌 것

- OAuth 는 HTTP 프로토콜과 독립적으로 정의되지 않는다.
- OAuth 는 인증 프로토콜이 아니다
- OAuth 는 인가 절차 메키니즘을 정의하지 않는다.
- OAuth는 토큰의 포맷을 정의하지 않는다.
- OAuth 2.0 은 OAuth 1.0 과 달리, 암호화 방법을 정의하지 않는다.
- OAuth 2.0 은 ㄷ단일 프로토콜이 아니다.

## 1.6 요약

- OAuth 는 토큰을 어떻게 획득하고 그것을 어떻게 사용하는지에 대한 스펙이다.
- OAuth 는 인가 접근 시스템을 위한 권한 위임 프로토콜이다.
- OAuth 는 보다 안전하고 유용한 권한 위임 프로토콜로 비밀번호 공유 패턴을 대체 한다.
- OAuth 는 작은 문제들을 잘 해결하는 것에 초점을 맞추고 있으며, 이를 통해 보다 큰 보안 시스템에서 적합한 구성 요소가 될 수 있다.
