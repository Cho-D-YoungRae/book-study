# Chapter 05. 스프링 데이터 JPA를 이용한 조회 기능

## 5.1 시작에 앞서

- CQRS 는 명령(Command) 모델과 조회(Query) 모델을 분리하는 패턴
- 명령 모델은 상태를 변경하는 기능을 구현할 때 사용
- 조회 모델은 데이터를 조회하는 기능을 구현할 떄 사용
- 도메인 모델은 명령 모델로 주로 사용됨

## 5.2 검색을 위한 스펙

- 목록 조회와 같은 기능은 다양한 검색 조건을 조합해야 함
- 검색 조건을 다양하게 조합해야 할 때 사용할 수 있는 것이 스펙(Specification)
- 애그리거트가 특정 조건을 충족하는지 검사할 때 사용하는 인터페이스
- 검색 대상을 메모리에서 걸러내도록 구현하면 모든 애그리거트 객체를 메모리에 보관하기도 어렵고 설사 메모리에 다 보관할 수 있다 하더라도 조회 성능에 심작한 문제가 발생하리 때문에 이렇게 구현 X

## 5.3 스프링 데이터 JPA를 이용한 스펙 구현

### JPA 정적 메타 모델

- 정적 메타 모델은 `@StaticMetamodel` 애너테이션을 이용해서 관련 모델 지정
- 메타 모델 클래스는 모델 클래스의 이름 뒤에 '_' 을 붙인 이름을 가짐
- 정적 메타 모델 클래스는 대상 모델의 각 프로퍼티와 동일한 이름을 갖는 정적 필드를 정의
- 문자열은 오타 가능성이 있고 실행하기 전까지는 오타가 있다는 것을 놓치기 쉬움
- 정적 메타 모델 클래스를 직접 작성할 수 있지만 하이버네이트와 같은 JPA 프로바이더는 정적 메타 모델을 생성하는 도구를 제공하고 있으므로 이들 도구를 사용하면 편리

## 5.4 리포지터리/DAO 에서 스펙 사용하기

- 스펙을 충족하는 엔티티를 검색하고 싶다면 `findAll()` 사용
