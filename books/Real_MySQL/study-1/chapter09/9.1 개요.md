# 9.1 개요

## 9.1.1 쿼리 실행 절차

1. 사용자로부터 요청된 SQL 문장을 잘게 쪼개서 MySQL 서버가 이해할 수 있는 수준으로 분리(파스 트리)
   - SQL 파싱
   - MySQL 서버의 'SQL 파서' 라는 모듈로 처리
   - 문법 오류 확인
   - 'SQL 파스 트리' 생성
   - MySQL 서버는 SQL 문장 그 자체가 아니라 SQL 파스 트리를 이용해 쿼리 실행
2. SQL의 파싱 정보(파스 트리)를 확인하면서 어떤 테이블부터 읽고 어떤 인덱스를 이용해 테이블을 읽을지 선택
   - 최적화 및 실행 계획 수립 단계
   - 첫 번째 단계에서 만들어진 SQL 파스 트리를 참조하면서 다음과 같은 내용 처리
     - 불필요한 조건 제거 및 복잡한 연산 단순화
     - 여러 테이블의 조인이 있는 경우 어떤 순서로 테이블을 읽을지 결정
     - 각 테이블에 사용된 조건과 인덱스 통계 정보를 이용해 사용할 인덱스 결정
     - 가져온 레코드들을 임시 테이블에 넣고 다시 한번 가공해야 하는지 결정
   - MySQL 서버의 '옵티마이서'에서 처리
   - 쿼리의 '실행 계획'이 만들어짐
3. 두 번째 단계에서 결정된 테이블의 읽기 순서나 선택된 인덱스를 이용해 스토리지 엔진으로부터 데이터를 가져옴
   - 수립된 실행 계획대로 스토리지 엔진에 레코드를 읽어오도록 요청
   - MySQL 엔진에서는 스토리지 엔진으로부터 받은 레코드를 조인하거나 정렬

> 첫 번째 단계와 두 번째 단계는 거의 MySQL 엔진에서 처리하며, 세 번쨰 단계는 MySQL 엔진과 스토리지 엔진이 동시에 참여해서 처리

## 9.1.2 옵티마이저의 종류

- `규칙 기반 최적화`
  - 거의 사용 X
- `비용 기반 최적화`
