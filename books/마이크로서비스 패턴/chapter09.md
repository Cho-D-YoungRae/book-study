# Chapter 09. 마이크로서비스 테스트 1부

## 9.1 마이크로서비스 아키텍처 테스트 전략

### 9.1.1 테스트 개요

#### 자동화 테스트 작성

SUT(System Under Test, 테스트 대상 시스템)

1. 설정(setup): SUT 와 그 디펜던시로 구성된 테스트 픽스처(test fixture)를 초기화
2. 실행(exercise): SUT 를 호출
3. 확인(verify): 호출 결과 및 SUT 상태를 단언(assertion)
4. 정리(teardown): 필요 시 테스트 픽스처를 깨끗이 정리

#### 목/스텁을 이용한 테스트

- 특정 테스트하기 위해 시스템 대부분을 가동시키지 않고 SUT 만 따로 테스트하기 위해 디펜던시를 테스트 더블(test double)로 대체
- 스텁(stub): SUT 에 값을 반환하는 테스트 더블
- 목(mock): 정확하게 디펜던시를 호출했는지 확인하는 테스트 더블
- 목은 스텁의 일종

#### 테스트 종류

- 단위 테스트(unit test): 서비스의 작은 부분(예: 클래스)을 테스트
- 통합 테스트(integration test): 애플리케이션 서비스가 인프라 서비스(예: DB) 및 타 애플리케이션 서비스와 잘 연동되어 작동되는지 확인
- 컴포넌트 테스트(component test): 개별 서비스에 대한 인수 테스트(acceptance test)
- 종단 간 테스트(end-to-end test): 전체 애플리케이션에 대한 인수 테스트
- 성능 테스트(performance test), 사용성 테스트(usability test)는 애플리케이션의 서비스 품질 수준을 확인하는 테스트

### 9.1.2 마이크로서비스 테스트

- 종단 간 테스트는 가능한 한 작성하지 않는 것이 최선

## 9.2 서비스 단위 테스트 작성

- 단위 테스트의 두 가지 종류
  - 독립(solitary) 단위 테스트: 클래스 디펜던시를 목 객체로 나타내고 클래스를 따로 테스트
  - 공동(sociable) 단위 테스트: 클래스와 디펜던시를 테스트
- 어떤 종류의 단위 테스트를 할지는 클래스의 책임과 아키텍처에서의 역할마다 다름
- 컨트롤러와 서비스 클래스는 독립 단위 테스트
- 엔터티와 밸류 객체 같은 도메인 객체는 공동 단위 테스트