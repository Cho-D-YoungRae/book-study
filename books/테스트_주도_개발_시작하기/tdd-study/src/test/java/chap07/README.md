# Chapter 7. 대역

## 대역의 필요성

- 테스트에서 외부 요인이 필요한 시점
  - 테스트 대상에서 파일 시스템을 사용
  - 테스트 대상에서 DB 이용
  - 테스트 대상에서 외부의 HTTP 서버와 통신

## 대역의 종류

| 대역 종류   | 설명 |
|---------|--|
| 스텁(Stub) | 구현을 단순한 것으로 대체한다. 테스트에 맞게 단순히 원하는 동작을 수행한다. |
| 가짜(Fake) | 제품에는 적합하지 않지만, 실제 동작하는 구현을 제공한다. |
| 스파이(Spy) | 호출된 내역을 기록한다. 기록한 내용은 테스트 결과를 검증할 때 사용한다. 스텁이기도 하다. |
| 모의(Mock) | 기대한 대로 상호작용하는지 행위를 검증한다. 기대한 대로 동작하지 않으면 익셉션을 발생할 수 있다. 모의 객체는 스텁이자 스파이도 된다. |

### 이메일 발송 여부를 확인하기 위해 스파이를 사용

- 이메일 발송 여부를 확인하는 방법 중 하나는 EmailNotifier 의 메일 발송 기능을 실행할 때 이메일 주소로 입력한 이메일을 사용했는지 확인하는 것
- 이런 용도로 사용할 수 있는 것이 스파이 대역

## 상황과 결과 확인을 위한 협업 대상(의존) 도출과 대역 사용

- 제어하기 힘든 외부 상황이 존재하면 다음과 같은 방법으로 의존을 도출하고 이를 대역으로 대신할 수 있음
  - 제어하기 ㅇ힘든 외부 상황을 별도 타입으로 분리
  - 테스트 코드는 별도로 분리한 타입의 대역을 생성
  - 생성한 대역을 테스트 대상의 생성자 등을 이용해서 전달
  - 대역을 이용해서 상황 구성
- 당장 구현하는데 시간이 오래 걸리는 로직도 분리하기에 좋은 후보

## 모의 객체를 과하게 사용하지 않기

- 모의 객체를 과하게 사용하면 오히려 테스트 코드가 복잡해질 수 있음
- 가짜 구현이 오히려 좋을 수 있음